<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <style>
        /* CSS STYLE */
        :root { --bg: linear-gradient(135deg, #f8fafc 0%, #eff6ff 100%); --c-bg: #ffffff; --txt: #1e293b; --txt-l: #475569; --p: #2563eb; --border: #cbd5e1; }
        body.dark-mode { --bg: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); --c-bg: #1e293b; --txt: #f1f5f9; --txt-l: #cbd5e1; --border: #475569; }
        * { font-family: 'Sarabun', sans-serif !important; box-sizing: border-box; }
        body { background: var(--bg); padding: 20px; color: var(--txt); transition: 0.3s; margin: 0; }
        .container { max-width: 1400px; margin: 0 auto; background: var(--c-bg); padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid var(--border); position: relative; }
        .theme-btn { position: absolute; top: 20px; right: 20px; width: 40px; height: 40px; border-radius: 50%; border: 1px solid var(--border); background: var(--c-bg); color: var(--txt); cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 100; }
        
        .lotto-header { text-align: center; margin-bottom: 20px; }
        .lotto-selector-group { display: inline-flex; align-items: center; gap: 10px; background: #f1f5f9; padding: 5px 15px; border-radius: 50px; border: 1px solid var(--border); margin-top: 10px; }
        body.dark-mode .lotto-selector-group { background: #334155; }
        select#lottoSelector { border: none; background: transparent; font-size: 16px; font-weight: 700; color: var(--p); cursor: pointer; outline: none; }
        
        .input-section { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 20px; }
        .input-box-main { flex: 1.5; min-width: 300px; }
        .input-box-add { flex: 1; min-width: 250px; background: #f0f9ff; padding: 20px; border-radius: 15px; border: 1px solid #bae6fd; display: flex; flex-direction: column; }
        body.dark-mode .input-box-add { background: #172554; border-color: #1e40af; }
        textarea { width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 10px; resize: vertical; background: var(--c-bg); color: var(--txt); font-size: 16px; font-weight: 500; }
        .history-area { height: 150px; } .add-area { height: 100px; }
        .label-head { font-weight: 800; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; color: var(--p); font-size: 18px; }
        .db-counter { background: #3b82f6; color: white; font-size: 12px; padding: 2px 8px; border-radius: 10px; margin-left: 5px; font-weight: 600; }
        .btn { padding: 5px 15px; border-radius: 20px; border: 1px solid var(--border); background: var(--c-bg); color: var(--txt-l); cursor: pointer; font-weight: 700; transition: 0.2s; font-size: 14px; }
        .btn:hover { transform: translateY(-1px); }
        .btn.active { background: var(--p); color: white; border-color: var(--p); }
        .btn-add { width: 100%; margin-top: 10px; padding: 10px; background: #10b981; color: white; border: none; border-radius: 8px; font-weight: 800; cursor: pointer; font-size: 16px; }

        .collapsible-container { border-radius: 15px; border: 1px solid var(--border); overflow: hidden; margin-bottom: 20px; background: var(--c-bg); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .collapsible-header { padding: 15px; background: #f1f5f9; cursor: pointer; font-weight: 700; display: flex; justify-content: space-between; align-items: center; color: var(--txt); border-bottom: 1px solid var(--border); }
        body.dark-mode .collapsible-header { background: #334155; }
        .collapsible-content { padding: 20px; display: block; }
        
        .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        @media (max-width: 900px) { .dashboard-grid { grid-template-columns: 1fr; } }
        
        .flow-section, .structure-section { background: var(--c-bg); padding: 15px; border-radius: 15px; border: 1px solid var(--border); }
        .flow-grid-wrapper, .struct-grid-wrapper { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; align-content: start; }
        .flow-card, .struct-card { border: 1px solid var(--border); border-radius: 10px; overflow: hidden; background: var(--c-bg); }
        .flow-header { padding: 6px 10px; font-weight: 700; color: white; font-size: 14px; display: flex; justify-content: space-between; align-items: center; }
        .flow-body, .struct-body { padding: 10px; text-align: center; }
        .flow-num-row { font-size: 18px; font-weight: 700; letter-spacing: 2px; margin-bottom: 5px; }
        .flow-trend-row { height: 4px; display: flex; gap: 1px; justify-content: center; align-items: flex-end; }
        .trend-bar { width: 6px; background: var(--border); border-radius: 1px; } .trend-bar.hot { background: #ef4444; }
        
        .bg-hundred { background: #ef4444; } .bg-tens-up { background: #f97316; } .bg-units-up { background: #eab308; color:black!important; } 
        .bg-up-all { background: #84cc16; } .bg-tens-down { background: #06b6d4; } .bg-units-down { background: #3b82f6; } .bg-down-all { background: #6366f1; } .bg-all { background: #a855f7; }
        .bg-sum-top { background: #be185d; } .bg-sum-bot { background: #0369a1; }
        
        .struct-text-row { font-size: 15px; font-weight: 700; color: var(--txt); margin-bottom: 5px; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .star-icon { color: #f59e0b; font-size: 14px; margin-left: 2px; }

        .smart-flow-box { border: 2px dashed #f59e0b; border-radius: 15px; padding: 20px; background: #fffbeb; margin-top: 20px; }
        body.dark-mode .smart-flow-box { background: #451a03; border-color: #d97706; }
        .sf-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap:10px; }
        .sf-controls { display: flex; gap: 5px; align-items: center; flex-wrap: wrap; }
        .sf-btn { background: #d97706; color: white; border: none; padding: 6px 18px; border-radius: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 2px 5px rgba(217, 119, 6, 0.3); }
        .sf-btn:hover { background: #b45309; }
        .sf-grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 15px; margin-top: 15px; }
        .sf-card { background: var(--c-bg); border: 1px solid var(--border); border-radius: 10px; padding: 10px; display: flex; flex-direction: column; box-shadow: 0 4px 10px rgba(0,0,0,0.05); height: 400px; }
        .sf-card-header { font-weight: 800; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; color: #b45309; border-bottom: 1px dashed var(--border); padding-bottom: 5px; }
        .sf-card-body { flex: 1; overflow-y: auto; font-family: monospace; font-size: 13px; line-height: 1.5; color: var(--txt); background: rgba(0,0,0,0.02); padding: 5px; border-radius: 5px; white-space: pre-wrap; }
        .sf-card-footer { margin-top: 10px; display: flex; justify-content: space-between; align-items: center; }
        .btn-copy-sf { background: var(--c-bg); border: 1px solid var(--p); color: var(--p); padding: 2px 8px; border-radius: 10px; cursor: pointer; font-size: 12px; font-weight: bold; }
        .btn-copy-sf:hover { background: var(--p); color: white; }

        /* CONTROLS */
        .control-panel { border-top: 2px solid var(--border); padding-top: 20px; }
        .display-mode-group { display: flex; gap: 10px; margin-bottom: 15px; justify-content: center; align-items: center; flex-wrap: wrap; }
        .hunt-toggle-group { display: flex; gap: 10px; justify-content: center; background: #fff7ed; padding: 8px; border-radius: 50px; width: fit-content; margin: 10px auto; border: 1px solid #ffedd5; }
        body.dark-mode .hunt-toggle-group { background: #451a03; border-color: #7c2d12; }
        .btn-hunt { padding: 6px 20px; border-radius: 30px; font-weight: 700; color: #9a3412; border: 1px solid transparent; background: transparent; cursor: pointer; font-size: 14px; }
        .btn-hunt.active { background: #f97316; color: white; }
        body.dark-mode .btn-hunt { color: #fdba74; }
        .btn-mode { padding: 8px 20px; border-radius: 50px; border: 1px solid var(--border); background: var(--c-bg); color: var(--txt); cursor: pointer; font-weight: 700; }
        .btn-mode.active { background: var(--p); color: white; }
        .manual-control { display: none; align-items: center; gap: 5px; font-size: 14px; }
        .page-btn { padding: 5px 15px; background: var(--p); color: white; border: none; border-radius: 20px; cursor: pointer; font-weight: bold; }
        .page-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .page-info { font-weight: bold; color: var(--txt); font-size: 14px; }
        
        .settings-bar { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; align-items: center; background: #f8fafc; padding: 12px 20px; border-radius: 12px; border: 1px solid #e2e8f0; margin-bottom: 20px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.02); }
        body.dark-mode .settings-bar { background: #334155; border-color: #475569; }

        .pattern-bar { display: flex; gap: 10px; justify-content: center; background: #f1f5f9; padding: 10px; border-radius: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .pattern-bar { background: var(--c-bg); border: 1px solid var(--border); }
        body.dark-mode .pattern-bar { background: #334155; }
        
        .btn-step, .btn-len { padding: 5px 12px; border: 1px solid var(--border); border-radius: 15px; background: var(--c-bg); color: var(--txt-l); cursor: pointer; font-weight: 600; font-size: 13px; }
        .btn-step.active, .btn-len.active { background: #7c3aed; color: white; border-color: #7c3aed; }
        .btn-len.active { background: var(--p); border-color: var(--p); }

        .btn-sort { padding: 6px 12px; border: 1px solid var(--border); border-radius: 15px; cursor: pointer; font-size: 14px; font-weight: 700; background: var(--c-bg); color: var(--txt-l); }
        .btn-sort.active { background: #f59e0b; color: white; border-color: #f59e0b; }
        .btn-sort.disabled { opacity: 0.4; cursor: not-allowed; pointer-events: none; }
        
        .grid-targets { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 8px; margin-bottom: 20px; }
        .btn-target { background: var(--c-bg); border: 2px solid var(--border); color: var(--txt-l); padding: 10px; border-radius: 10px; cursor: pointer; font-size: 13px; font-weight: 600; white-space: nowrap; }
        .btn-target:hover { border-color: var(--p); color: var(--p); }
        .btn-target.active { background: #eff6ff; border-color: var(--p); color: #1e40af; }
        body.dark-mode .btn-target.active { background: #1e3a8a; color: #93c5fd; }
        input[type=number], input[type=text] { padding: 5px; border-radius: 5px; border: 1px solid var(--border); text-align: center; background: var(--c-bg); color: var(--txt); width: 50px; font-size: 14px; font-weight: 600; }
        
        .table-wrapper { margin-top: 20px; width: 100%; border-radius: 15px; border: 1px solid var(--border); overflow: auto; position: relative; }
        table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 16px; white-space: nowrap; }
        th { background: #334155; color: white; padding: 12px; position: sticky; top: 0; z-index: 50; font-weight: 600; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        th:first-child { left: 0; z-index: 60; background: #212529; border-right: 2px solid #475569; }
        td { padding: 10px; text-align: center; border-bottom: 1px solid var(--border); border-right: 1px solid var(--border); font-size: 18px; color: var(--txt); }
        td:first-child { position: sticky; left: 0; z-index: 40; background: #fef08a; font-weight: 800; color: black; border-right: 2px solid #cbd5e1; box-shadow: 2px 0 5px rgba(0,0,0,0.05); }
        body.dark-mode td:first-child { background: #854d0e; color: #fef08a; border-color: #475569; }
        
        .stat-t { color: #16a34a; font-weight: 900; font-size: 1.2em; }
        .stat-f { color: #dc2626; font-weight: 900; font-size: 1.2em; }
        .hunt-tag { font-size: 12px; padding: 2px 6px; border-radius: 6px; margin-left: 3px; color: white; font-weight: 600; }
        .hunt-tag.win { background: #10b981; } .hunt-tag.wait { background: #f59e0b; }
        
        .vin-flow-section { margin-top: 20px; background: var(--c-bg); border: 1px solid var(--border); border-radius: 15px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .vin-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px dashed var(--border); padding-bottom: 10px; margin-bottom: 15px; flex-wrap: wrap; gap:10px; }
        .vin-title { font-size: 18px; font-weight: 700; color: var(--txt); }
        .vin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 700px) { .vin-grid { grid-template-columns: 1fr; } }
        .vin-box { border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
        .vin-head { padding: 10px; color: white; font-weight: 700; text-align: center; display: flex; justify-content: space-between; font-size: 15px; }
        .vin-body { padding: 15px; text-align: center; font-size: 16px; font-weight: 600; line-height: 1.8; word-wrap: break-word; color: var(--txt); }
        .bg-vin-up { background: linear-gradient(to right, #f59e0b, #d97706); }
        .bg-vin-down { background: linear-gradient(to right, #3b82f6, #2563eb); }
        .btn-tiny { background: rgba(255,255,255,0.25); border: none; color: white; cursor: pointer; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-family: 'Sarabun'; }
        .btn-star { background: none; border: none; cursor: pointer; font-size: 16px; color: #cbd5e1; margin-right: 4px; }
        .btn-star.pinned { color: #f59e0b; transform: scale(1.2); }
        .alert-bar { display: none; background-color: #fee2e2; border: 2px solid #ef4444; color: #b91c1c; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; font-weight: 700; }
        .toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #1e293b; color: white; padding: 10px 25px; border-radius: 50px; font-weight: 600; display: none; z-index: 1000; box-shadow: 0 5px 15px rgba(0,0,0,0.3); font-size: 14px; }
        .btn-copy-col { background: none; border: none; cursor: pointer; font-size: 14px; color: #cbd5e1; margin-left: 5px; transition: 0.2s; }
        .btn-copy-col:hover { color: #fcc419; transform: scale(1.2); }
        .table-footer-controls { display: none; justify-content: center; align-items: center; margin-top: 15px; gap: 15px; padding: 10px; background: #f1f5f9; border-radius: 10px; }
        body.dark-mode .table-footer-controls { background: #334155; }
        .manual-limit-input { width: 70px !important; margin-left: 5px; }
        .copy-container { margin-top:20px; text-align:center; }
        .btn-line { background: #10b981; color: white; border: none; padding: 10px 40px; border-radius: 50px; font-weight: 800; font-size: 16px; box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3); cursor: pointer; }

        .num-match { color: #db2777; font-weight: 900; }
        .row-line { display: flex; justify-content: space-between; border-bottom: 1px dashed #e2e8f0; padding: 2px 0; }
        body.dark-mode .row-line { border-color: #334155; }
        body.dark-mode .num-match { color: #f472b6; }
        .num-normal { opacity: 0.8; }
/* === ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô <style> ‡∏Ç‡∏≠‡∏á github1 === */

/* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
:root { --green-active: #10b981; }
body.dark-mode { --green-active: #059669; }

/* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Layout ‡∏õ‡∏∏‡πà‡∏° */
.grid-targets { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); 
    gap: 8px; 
    margin-bottom: 20px; 
}

/* ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏£‡∏á‡∏°‡∏ô */
.btn-target { 
    background: var(--c-bg); 
    border: 1px solid var(--border); 
    color: var(--txt-l); 
    padding: 8px 10px; 
    border-radius: 20px; /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏ô */
    cursor: pointer; 
    font-size: 13px; 
    font-weight: 700; 
    white-space: nowrap; 
    transition: all 0.2s;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

/* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏ï‡∏≠‡∏ô‡∏ä‡∏µ‡πâ‡πÄ‡∏°‡∏≤‡∏™‡πå */
.btn-target:hover { 
    transform: translateY(-2px); 
    border-color: var(--green-active); 
    color: var(--green-active); 
    box-shadow: 0 4px 6px rgba(16, 185, 129, 0.15); 
}

/* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏ï‡∏≠‡∏ô‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß) */
.btn-target.active { 
    background: var(--green-active) !important; 
    border-color: var(--green-active) !important; 
    color: white !important; 
    box-shadow: 0 4px 10px rgba(16, 185, 129, 0.4); 
    transform: translateY(-1px);
}
    </style>
</head>
<body>

<div class="container">
    <button class="theme-btn" onclick="toggleTheme()">üåô</button>
    <div style="height:20px;"></div>
    <div id="alertBox" class="alert-bar"></div>
    
    <div class="lotto-header">
        <h2 style="margin-bottom:10px; font-weight:800; color:var(--txt);">üî¢ AI CALCULATOR <span style="font-size:12px; background:var(--p); color:white; padding:2px 8px; border-radius:10px;">ULTIMATE AI</span></h2>
        
        <div class="lotto-selector-group">
            <select id="lottoSelector" onchange="changeLottoType()">
                <option value="thai">üáπüá≠ ‡∏´‡∏ß‡∏¢‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•</option>
                <option value="lao">üá±üá¶ ‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß</option>
                <option value="hanoi">üáªüá≥ ‡∏´‡∏ß‡∏¢‡∏Æ‡∏≤‡∏ô‡∏≠‡∏¢</option>
                <option value="yeekee">üé∞ ‡∏´‡∏ß‡∏¢‡∏¢‡∏µ‡πà‡∏Å‡∏µ</option>
                <option value="stock">üìà ‡∏´‡∏ß‡∏¢‡∏´‡∏∏‡πâ‡∏ô/‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
            </select>
            <span id="dbCount" class="db-counter">0 ‡∏á‡∏ß‡∏î</span>
            <button onclick="renameLotto()" class="btn" style="padding:2px 8px; font-size:12px; border:none; background:transparent;">‚úèÔ∏è</button>
        </div>
    </div>

    <div class="collapsible-container">
        <div class="collapsible-header" onclick="toggleSection('inputContent', 'inputIcon')">
            <span>üìù ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</span><span id="inputIcon">‚ñº</span>
        </div>
        <div id="inputContent" class="collapsible-content">
            <div class="input-section">
                <div class="input-box-main">
                    <div class="label-head"><span>üìö ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span><div><button onclick="toggleEditData()" id="btnEdit" class="btn">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button> <button onclick="clearAll()" class="btn" style="color:#ef4444;">‡∏•‡πâ‡∏≤‡∏á</button></div></div>
                    <textarea id="inputData" class="history-area" placeholder="‡∏ß‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." readonly></textarea>
                </div>
                <div class="input-box-add">
                    <div class="label-head"><span>‚ûï ‡πÄ‡∏ï‡∏¥‡∏°‡∏á‡∏ß‡∏î‡πÉ‡∏´‡∏°‡πà</span><button class="btn" id="btnOrder" onclick="toggleOrder()">‚¨á ‡∏õ‡∏Å‡∏ï‡∏¥</button></div>
                    <textarea id="newData" class="add-area"></textarea>
                    <button class="btn-add" onclick="appendAndRun()">‡πÄ‡∏û‡∏¥‡πà‡∏° + ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
                </div>
            </div>
        </div>
    </div>

    <div class="collapsible-container">
        <div class="collapsible-header" onclick="toggleSection('dashAnalytics', 'dashIcon1')">
            <span>üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏• (Flow & Structure)</span><span id="dashIcon1">‚ñº</span>
        </div>
        <div id="dashAnalytics" class="collapsible-content">
            <div class="dashboard-grid">
                <div class="flow-section" id="flowPanel" style="display:none;">
                    <div class="label-head" style="justify-content:center;">üåä ‡πÄ‡∏•‡∏Ç‡πÑ‡∏´‡∏• (Flow 10 ‡∏´‡∏•‡∏±‡∏Å)</div>
                    <div id="flowGridWrapper" class="flow-grid-wrapper"></div>
                </div>
                <div class="structure-section" id="structurePanel" style="display:none;">
                    <div class="label-head" style="justify-content:center;">üìä ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á (Structure)</div>
                    <div id="structGridWrapper" class="struct-grid-wrapper"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="collapsible-container" style="margin-top: 20px;">
        <div class="collapsible-header" onclick="toggleSection('dashSmartFlow', 'dashIcon2')">
            <span>üìù ‡∏à‡∏±‡∏î‡∏ä‡∏∏‡∏î‡πÑ‡∏´‡∏• (Smart Flow Top 5)</span><span id="dashIcon2">‚ñº</span>
        </div>
        <div id="dashSmartFlow" class="collapsible-content">
            <div class="smart-flow-box" style="margin-top:0; border:none; box-shadow:none;">
                <div class="sf-header">
                    <span style="font-size:16px; font-weight:800; color:#b45309;">üìù ‡∏à‡∏±‡∏î‡∏ä‡∏∏‡∏î‡πÑ‡∏´‡∏• (Smart Flow Top 5)</span>
                    <div class="sf-controls">
                        <select id="sfTarget" class="btn" style="padding:4px;">
                            <option value="0">1. ‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢</option>
                            <option value="1">2. ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏¥‡∏ö‡∏ö‡∏ô</option>
                            <option value="2">3. ‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏ô</option>
                            <option value="3">4. ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ö‡∏ô (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏£‡πâ‡∏≠‡∏¢)</option>
                            <option value="4">5. ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏¥‡∏ö‡∏•‡πà‡∏≤‡∏á</option>
                            <option value="5">6. ‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡πà‡∏≤‡∏á</option>
                            <option value="6">7. ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏•‡πà‡∏≤‡∏á</option>
                            <option value="7">8. ‡∏ö‡∏ô+‡∏•‡πà‡∏≤‡∏á (‡∏£‡∏ß‡∏°)</option>
                            <option value="8">9. ‡πÅ‡∏ï‡πâ‡∏°‡∏ö‡∏ô</option>
                            <option value="9">10. ‡πÅ‡∏ï‡πâ‡∏°‡∏•‡πà‡∏≤‡∏á</option>
                            <option value="10">11. ‡∏ß‡∏¥‡∏ô‡∏ö‡∏ô (‡∏Ñ‡∏£‡∏ö 2 ‡∏ï‡∏±‡∏ß)</option>
                            <option value="11">12. ‡∏ß‡∏¥‡∏ô‡∏•‡πà‡∏≤‡∏á (‡∏Ñ‡∏£‡∏ö 2 ‡∏ï‡∏±‡∏ß)</option>
                        </select>
                        <span style="font-size:12px; font-weight:bold;">‡πÄ‡∏≠‡∏≤:</span>
                        <input type="number" id="sfLen" value="4" min="1" max="9" style="width:40px;" title="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç">
                        <span style="font-size:12px; font-weight:bold;">‡∏¢‡πâ‡∏≠‡∏ô:</span>
                        <input type="number" id="sfLookback" value="10" style="width:40px;" title="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î">
                        <button class="sf-btn" onclick="genSmartFlow()">üöÄ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
                        <button class="btn" onclick="copySmartFlow()">Copy All</button>
                    </div>
                </div>
                <div id="sfOutput" class="sf-grid-container"></div>
            </div>
        </div>
    </div>
    
    <div class="collapsible-container" style="margin-top: 20px;">
    <div class="collapsible-header" onclick="toggleSection('followContent', 'dashIcon3')">
        <span>üîç ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏•‡∏Ç‡∏ï‡∏≤‡∏° (Cross-Position & High-Low)</span><span id="dashIcon3">‚ñº</span>
    </div>
    <div id="followContent" class="collapsible-content">
        <div class="smart-flow-box" style="margin-top:0; border:none; box-shadow:none; background:#f0fdf4; border:2px dashed #16a34a;">
            <div class="sf-header">
                <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:center;">
                    <div style="background:rgba(255,255,255,0.6); padding:5px; border-radius:10px; border:1px solid #dcfce7;">
                        <span style="font-weight:bold; color:#15803d;">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç:</span>
                        <span style="font-size:14px;">‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏Ç</span>
                        <select id="followNum" class="btn" style="padding:2px 5px;">
                            <option value="0">0</option><option value="1">1</option><option value="2">2</option>
                            <option value="3">3</option><option value="4">4</option><option value="5">5</option>
                            <option value="6">6</option><option value="7">7</option><option value="8">8</option>
                            <option value="9">9</option>
                        </select>
                        <span style="font-size:14px;">‡∏°‡∏≤‡∏ó‡∏µ‡πà</span>
                        <select id="sourcePos" class="btn" style="padding:2px 5px;">
                            <option value="0">‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢</option>
                            <option value="1" selected>‡∏™‡∏¥‡∏ö‡∏ö‡∏ô</option>
                            <option value="2">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏ô</option>
                            <option value="3">‡∏™‡∏¥‡∏ö‡∏•‡πà‡∏≤‡∏á</option>
                            <option value="4">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡πà‡∏≤‡∏á</option>
                            <option value="5">‡πÅ‡∏ï‡πâ‡∏°‡∏ö‡∏ô (‡∏£‡∏ß‡∏°)</option>
                            <option value="6">‡πÅ‡∏ï‡πâ‡∏°‡∏•‡πà‡∏≤‡∏á (‡∏£‡∏ß‡∏°)</option>
                        </select>
                    </div>
                    
                    <div style="font-size:20px; color:#16a34a;">üëâ</div>

                    <div style="background:rgba(255,255,255,0.6); padding:5px; border-radius:10px; border:1px solid #fef9c3;">
                        <span style="font-weight:bold; color:#b45309;">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</span>
                        <span style="font-size:14px;">‡∏î‡∏π‡∏ó‡∏µ‡πà</span>
                        <select id="targetPos" class="btn" style="padding:2px 5px; border-color:#b45309; color:#b45309;">
                            <option value="0">‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢</option>
                            <option value="1">‡∏™‡∏¥‡∏ö‡∏ö‡∏ô</option>
                            <option value="2">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏ô</option>
                            <option value="3">‡∏™‡∏¥‡∏ö‡∏•‡πà‡∏≤‡∏á</option>
                            <option value="4">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡πà‡∏≤‡∏á</option>
                            <option value="5">‡πÅ‡∏ï‡πâ‡∏°‡∏ö‡∏ô (‡∏£‡∏ß‡∏°)</option>
                            <option value="6">‡πÅ‡∏ï‡πâ‡∏°‡∏•‡πà‡∏≤‡∏á (‡∏£‡∏ß‡∏°)</option>
                        </select>
                    </div>

                    <div style="display:flex; gap:5px; justify-content:center; align-items:center; margin-top:10px;">
    <button class="sf-btn" style="background:#16a34a;" onclick="calcFollowing()">üöÄ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
    <button class="sf-btn" style="background:#ffffff; color:#16a34a; border:1px solid #16a34a; box-shadow:none;" onclick="copyFollowResult()">üìã Copy</button>
</div>
                </div>
            </div>
            
            <div id="hlPrediction" style="margin-top:15px; padding:10px; background:white; border-radius:10px; display:none; border:1px solid #e2e8f0; text-align:center;"></div>
            <div id="followOutput" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(60px, 1fr)); gap:10px; margin-top:15px;"></div>
        </div>
    </div>
</div>

<div class="collapsible-container" style="margin-top: 20px;">
    <div class="collapsible-header" onclick="toggleSection('pairFollowContent', 'dashIcon4')">
        <span>üë• ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏•‡∏Ç‡∏ï‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà (Pair Follow) 2 ‡∏ï‡∏±‡∏ß</span><span id="dashIcon4">‚ñº</span>
    </div>
    <div id="pairFollowContent" class="collapsible-content">
        <div class="smart-flow-box" style="margin-top:0; border:none; box-shadow:none; background:#ecfdf5; border:2px dashed #059669;">
            <div class="sf-header">
               <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:center;">
                    <div style="background:rgba(255,255,255,0.6); padding:5px; border-radius:10px; border:1px solid #a7f3d0;">
                        <span style="font-weight:bold; color:#059669;">‡∏ñ‡πâ‡∏≤ 2 ‡∏ï‡∏±‡∏ß</span>
                        <select id="pairSourcePos" class="btn" style="padding:2px 5px;">
                            <option value="up">‡∏ö‡∏ô (‡∏ó‡πâ‡∏≤‡∏¢)</option>
                            <option value="down">‡∏•‡πà‡∏≤‡∏á</option>
                        </select>
                        <span>‡∏≠‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç</span>
                        <input type="number" id="pairInput" class="btn" style="width:60px; padding:2px 5px;" placeholder="‡πÄ‡∏ä‡πà‡∏ô 85">
                    </div>
                    
                    <span style="font-size:20px; color:#059669;">üëâ</span>
                    
                    <div style="background:rgba(255,255,255,0.6); padding:5px; border-radius:10px; border:1px solid #fef9c3;">
                        <span>‡∏î‡∏π 2 ‡∏ï‡∏±‡∏ß</span>
                        <select id="pairTargetPos" class="btn" style="padding:2px 5px;">
                            <option value="up">‡∏ö‡∏ô (‡∏ó‡πâ‡∏≤‡∏¢)</option>
                            <option value="down">‡∏•‡πà‡∏≤‡∏á</option>
                        </select>
                    </div>
                    
                    <button class="sf-btn" style="background:#059669;" onclick="calcPairFollow()">üöÄ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
               </div>
            </div>
            
            <div id="pairHlPrediction" style="margin-top:15px; padding:10px; background:white; border-radius:10px; display:none; border:1px solid #e2e8f0; text-align:center;"></div>
            <div id="pairOutput" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap:10px; margin-top:15px;"></div>
        </div>
    </div>
</div>

    <div class="control-panel">
        <div class="display-mode-group">
            <button class="btn-mode active" id="btnModeAuto" onclick="setMode('auto')">ü§ñ Auto (Top 5)</button>
            <button class="btn-mode" id="btnModeAll" onclick="setMode('all')">üìú Manual (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)</button>
            <div id="manualControl" class="manual-control">
                <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏ï‡∏£: <input type="number" id="manualLimitInput" class="manual-limit-input" value="100" min="10" onchange="runProgram()"></span>
            </div>
        </div>

        <div class="hunt-toggle-group">
            <button class="btn-hunt active" id="btnHuntOff" onclick="setHunt(false)">üéØ ‡∏õ‡∏Å‡∏ï‡∏¥</button>
            <button class="btn-hunt" id="btnHuntOn" onclick="setHunt(true)">üî´ ‡∏•‡πà‡∏≤</button>
            <span id="huntInputWrap" style="display:none; align-items:center; margin-left:10px;">
                ‡∏ï‡∏≤‡∏° <input type="number" id="huntMax" value="3" style="width:40px;"> ‡∏á‡∏ß‡∏î
            </span>
        </div>

        <div style="text-align:center; margin-bottom:10px;">
            <button class="btn-sort active" id="sortScore" onclick="setSort('score')">üèÜ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô</button>
            <button class="btn-sort" id="sortFixed" onclick="setSort('fixed')">üî§ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏π‡∏ï‡∏£ (‡∏Ñ‡∏á‡∏ó‡∏µ‡πà)</button>
        </div>

        <div class="settings-bar" style="justify-content: center; gap: 15px; flex-wrap: wrap; background: #f8fafc; border: 1px solid #e2e8f0; padding: 12px; border-radius: 12px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 20px;">
            <div style="display:flex; align-items:center; gap:5px;">
                <span style="font-weight:700; color:#334155;">üìÖ ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</span>
                <input type="number" id="rangeCount" value="10" oninput="updateRangeFromCount()" style="width:50px; text-align:center; padding:4px; border:2px solid #cbd5e1; border-radius:6px; font-weight:bold; color:#1e3a8a;">
                <span style="font-size:13px; font-weight:700; color:#64748b;">‡∏á‡∏ß‡∏î</span>
            </div>
            <div style="display:flex; align-items:center; gap:5px; border-left:2px solid #e2e8f0; padding-left:10px;">
                <span style="font-weight:700; color:#334155;">üîé ‡πÄ‡∏£‡∏¥‡πà‡∏°:</span>
                <input type="number" id="rangeStart" oninput="updateCountFromRange()" style="width:50px; text-align:center; padding:4px; border:2px solid #cbd5e1; border-radius:6px; font-weight:bold; color:#475569;">
                <span style="font-weight:700; color:#334155;">‡∏ñ‡∏∂‡∏á</span>
                <input type="number" id="rangeEnd" oninput="updateCountFromRange()" style="width:50px; text-align:center; padding:4px; border:2px solid #cbd5e1; border-radius:6px; font-weight:bold; color:#475569;">
            </div>
            <div style="display:flex; align-items:center; gap:5px; border-left:2px solid #e2e8f0; padding-left:10px;">
                <span style="color:#2563eb; font-weight:800;">‚è© ‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</span>
                <input type="number" id="forwardTest" value="0" min="0" max="20" onchange="runProgram()" title="‡∏ï‡∏±‡∏î‡∏ú‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏≠‡∏≠‡∏Å X ‡∏á‡∏ß‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏π‡∏ï‡∏£" style="width:50px; text-align:center; padding:4px; border:2px solid #3b82f6; border-radius:6px; font-weight:bold; color:#1e3a8a;">
                <span style="font-size:13px; font-weight:700; color:#2563eb;">‡∏á‡∏ß‡∏î</span>
            </div>
            <div style="display:flex; align-items:center; gap:5px; border-left:2px solid #e2e8f0; padding-left:10px;">
                <span style="color:#dc2626; font-weight:800;">‚õî ‡∏ú‡∏¥‡∏î ‚â§</span>
                <input type="number" id="maxLoss" placeholder="-" onchange="runProgram()" title="‡∏™‡∏π‡∏ï‡∏£‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏£‡∏ß‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏ô‡∏µ‡πâ" style="width:50px; text-align:center; padding:4px; border:2px solid #ef4444; border-radius:6px; font-weight:bold; color:#b91c1c;">
            </div>
            <div style="display:flex; align-items:center; gap:5px;">
                <span style="color:#dc2626; font-weight:800;">üìâ ‡∏ã‡πâ‡∏≥ ‚â§</span>
                <input type="number" id="maxConsLoss" placeholder="-" onchange="runProgram()" title="‡∏™‡∏π‡∏ï‡∏£‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ú‡∏¥‡∏î‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏ô‡∏µ‡πâ" style="width:50px; text-align:center; padding:4px; border:2px solid #ef4444; border-radius:6px; font-weight:bold; color:#b91c1c;">
            </div>
            <div style="display:flex; align-items:center; gap:5px; border-left:2px solid #e2e8f0; padding-left:10px;">
                <span style="color:#9333ea; font-weight:800;">‚úÇÔ∏è ‡∏ï‡∏±‡∏î‡πÄ‡∏•‡∏Ç:</span>
                <input type="text" id="killDigits" placeholder="‡πÄ‡∏ä‡πà‡∏ô 05" onchange="runProgram()" style="width:70px; text-align:center; padding:4px; border:2px solid #a855f7; border-radius:6px; font-weight:bold; color:#6b21a8;">
            </div>
            <input type="hidden" id="manualLimitInput" value="100">
        </div>

        <div class="pattern-bar" style="justify-content: space-between;">
            <div style="display:flex; gap:5px; align-items:center;">
                <span style="font-weight:bold; font-size:13px;">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:</span>
                <button class="btn-step active" onclick="setStep('normal', this)">‡πÄ‡∏£‡∏µ‡∏¢‡∏á</button>
                <button class="btn-step" onclick="setStep('odd', this)">‡∏Ñ‡∏µ‡πà</button>
                <button class="btn-step" onclick="setStep('even', this)">‡∏Ñ‡∏π‡πà</button>
                <button class="btn-step" onclick="setStep('step3', this)">‡∏Ç‡πâ‡∏≤‡∏°3</button>
            </div>
            <div style="display:flex; gap:3px; align-items:center;">
                <span style="font-weight:bold; font-size:13px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</span>
                <button class="btn-len" onclick="setLen(1, this)">1</button>
                <button class="btn-len" onclick="setLen(2, this)">2</button>
                <button class="btn-len" onclick="setLen(3, this)">3</button>
                <button class="btn-len" onclick="setLen(4, this)">4</button>
                <button class="btn-len active" onclick="setLen(5, this)">5</button>
                <button class="btn-len" onclick="setLen(6, this)">6</button>
                <button class="btn-len" onclick="setLen(7, this)">7</button>
                <button class="btn-len" onclick="setLen(8, this)">8</button>
                <button class="btn-len" onclick="setLen(9, this)">9</button>
            </div>
        </div>

        <div class="grid-targets">
    <button class="btn-target active" onclick="setTarget('hundred', this)">üíØ ‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢</button>
    <button class="btn-target" onclick="setTarget('tens_up', this)">‚¨ÜÔ∏è ‡∏™‡∏¥‡∏ö‡∏ö‡∏ô</button>
    <button class="btn-target" onclick="setTarget('units_up', this)">‚ÜóÔ∏è ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏ô</button>
    <button class="btn-target" onclick="setTarget('tens_down', this)">‚¨áÔ∏è ‡∏™‡∏¥‡∏ö‡∏•‡πà‡∏≤‡∏á</button>
    <button class="btn-target" onclick="setTarget('units_down', this)">‚ÜòÔ∏è ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡πà‡∏≤‡∏á</button>
    <button class="btn-target" style="color:var(--p); border-color:var(--p);" onclick="setTarget('tf_up', this)">üé≤ ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ö‡∏ô</button>
    <button class="btn-target" style="color:var(--p); border-color:var(--p);" onclick="setTarget('tf_down', this)">üé≤ ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏•‡πà‡∏≤‡∏á</button>
    <button class="btn-target" style="color:#6610f2; border-color:#6610f2;" onclick="setTarget('pair_up', this)">üçí ‡∏ß‡∏¥‡∏ô‡∏ö‡∏ô</button>
    <button class="btn-target" style="color:#6610f2; border-color:#6610f2;" onclick="setTarget('pair_down', this)">üçí ‡∏ß‡∏¥‡∏ô‡∏•‡πà‡∏≤‡∏á</button>
    <button class="btn-target" style="color:#dc3545; border-color:#dc3545;" onclick="setTarget('any_no_hundred', this)">üé≤ ‡∏ö‡∏ô/‡∏•‡πà‡∏≤‡∏á*</button>
</div>

        <button class="btn-add" style="background:var(--p); width:200px; display:block; margin:0 auto;" onclick="runProgram()">üöÄ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</button>
    </div>

    <div id="loading" style="text-align:center; padding:20px; display:none; color:#888;">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</div>
    <div class="table-wrapper" id="tableWrapper" style="display:none;"><div id="resultContainer"></div></div>
    
    <div id="tableFooterControls" class="table-footer-controls">
        <button class="page-btn" onclick="changePage(-1)">‚ùÆ ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
        <span id="pageInfo" class="page-info">1-10</span>
        <button class="page-btn" onclick="changePage(1)">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ùØ</button>
    </div>

    <div id="consensusSection" class="consensus-box" style="display:none; margin-top:20px; padding:15px; background:#fff7ed; border:2px solid #fdba74; border-radius:15px; text-align:center;">
        <div style="font-size:20px; font-weight:800; color:#9a3412; margin-bottom:10px;">üèÜ ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏•‡∏Ç‡∏ä‡∏ô</div>
        <div id="consensusContent" style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap;"></div>
    </div>
    
    <div id="copyArea" class="copy-container" style="display:none;">
        <button class="btn-line" onclick="copyToLine()">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>

    <div class="vin-flow-section" id="vinFlowSection" style="display:none;">
        <div class="vin-header">
            <div class="vin-title">üí∞ ‡∏à‡∏±‡∏ö‡∏ß‡∏¥‡∏ô‡πÄ‡∏•‡∏Ç‡πÑ‡∏´‡∏• (Auto Flow Vin)</div>
            <div>
                ‡∏ï‡∏±‡∏î‡∏Å‡∏µ‡πà‡∏ï‡∏±‡∏ß: <input type="number" id="vinFlowLimit" value="5" min="2" max="9" onchange="calcVinFlow()" style="width:40px;"> 
                ‡∏ï‡∏±‡∏î‡πÅ‡∏ï‡πâ‡∏°: <input type="text" id="vinFlowSumKill" placeholder="05" onkeyup="calcVinFlow()" style="width:50px;">
            </div>
        </div>
        <div class="vin-grid">
            <div class="vin-box">
                <div class="vin-head bg-vin-up"><span>üçí ‡∏ß‡∏¥‡∏ô‡∏ö‡∏ô</span><button class="btn-tiny" onclick="copyFlowVin('up')">Copy</button></div>
                <div id="vinFlowUpContent" class="vin-body">...</div>
            </div>
            <div class="vin-box">
                <div class="vin-head bg-vin-down"><span>üçí ‡∏ß‡∏¥‡∏ô‡∏•‡πà‡∏≤‡∏á</span><button class="btn-tiny" onclick="copyFlowVin('down')">Copy</button></div>
                <div id="vinFlowDownContent" class="vin-body">...</div>
            </div>
        </div>
    </div>

    <div style="height:50px;"></div>
    <div id="toast" class="toast">‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!</div>
    <input type="hidden" id="manualLimitInput" value="100">
</div>

<script>
let currentFollowStr = ""; // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏•‡∏Ç 10 ‡∏ï‡∏±‡∏ß

    // --- WORKER: Dynamic Patterns ---
    const workerScript = `
    self.onmessage = function(e) {
        const { intData, targetType, len, displayMode, startIdx, endIdx, manualLimit, killDigits, isHuntingMode, huntMax, seed, stepMode, page, pageSize } = e.data;
        let results = findFormulasLite(intData, targetType, len, displayMode, startIdx, endIdx, manualLimit, killDigits, isHuntingMode, huntMax, seed, stepMode, page, pageSize);
        self.postMessage({status:'success', data:results});
    };

    function sfc32(a, b, c, d) {
        return function() {
            a >>>= 0; b >>>= 0; c >>>= 0; d >>>= 0; 
            var t = (a + b) | 0; a = b ^ b >>> 9; b = c + (c << 3) | 0; c = (c << 21 | c >>> 11); d = d + 1 | 0; t = t + d | 0; c = c + t | 0;
            return (t >>> 0) / 4294967296;
        }
    }

    // Dynamic Additives based on Step Mode
    function getAdditives(len, mode) {
        let arr = []; let step = 1; let start = 0;
        if(mode === 'odd') { start=1; step=2; } else if(mode === 'even') { start=0; step=2; } else if(mode === 'step3') { start=0; step=3; }
        for(let i=0; i<len; i++) arr.push((start + (i*step)) % 10);
        return arr;
    }

    function getTargetValue(roundArr, type) {
        if(type==='hundred') return [roundArr[0]]; if(type==='tens_up') return [roundArr[1]]; if(type==='units_up') return [roundArr[2]];
        if(type==='tens_down') return [roundArr[3]]; if(type==='units_down') return [roundArr[4]];
        if(type==='tf_up') return [roundArr[1], roundArr[2]]; if(type==='tf_down') return [roundArr[3], roundArr[4]]; 
        if(type==='pair_up') return [roundArr[1], roundArr[2]]; if(type==='pair_down') return [roundArr[3], roundArr[4]]; 
        if(type==='any_no_hundred') return [roundArr[1], roundArr[2], roundArr[3], roundArr[4]]; 
        return []; 
    }

    function checkWin(targets, nums, type) {
        let match = 0; for (let t of targets) if (nums.includes(t)) match++;
        if (type.includes('pair')) return match === targets.length; 
        if (type.includes('tf') || type.includes('any')) return match > 0;
        return match > 0; 
    }

    function findFormulasLite(intData, targetType, len, displayMode, startIdx, endIdx, manualLimit, killDigits, isHuntingMode, huntMax, seed, stepMode, page, pageSize) {
        let totalChecks = intData.length - 1;
        const targetVals = [];
        for(let i=0; i < totalChecks; i++) targetVals.push(getTargetValue(intData[i+1], targetType));
        
        let randFunc = Math.random;
        if (displayMode === 'all' || isHuntingMode) {
             let seedVal = 12345 + (targetType.length * 100) + len;
             randFunc = sfc32(seedVal, seedVal+1, seedVal+2, seedVal+3);
        }

        const positions = [0, 1, 2, 3, 4]; const operators = ['+', '-', '*']; const constants = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]; 
        let allResults = [];
        const MAX_SEARCH = 2000; 
        
        let additives = getAdditives(len, stepMode);

        for (let r = 0; r < MAX_SEARCH; r++) {
            let p1 = positions[Math.floor(randFunc() * 5)]; let p2 = positions[Math.floor(randFunc() * 5)];
            let op = operators[Math.floor(randFunc() * 3)]; let con = constants[Math.floor(randFunc() * 10)]; let m1 = Math.floor(randFunc() * 5) + 1;
            
            const baseSums = new Int8Array(intData.length);
            for(let i=1; i<intData.length; i++) { 
                let v1 = intData[i][p1]; let v2 = intData[i][p2]; let res = 0;
                if (op === '+') res = (v1 * m1) + v2; else if (op === '-') res = (v1 * m1) - v2; else if (op === '*') res = (v1 * m1) * v2;
                if (isNaN(res)) res = 0;
                baseSums[i] = Math.floor(Math.abs(res) + con) % 10;
            }
            
            let name = \`(\${m1>1?m1+'x':''}\${['‡∏£','‡∏™','‡∏ô','‡∏•‡∏™','‡∏•‡∏ô'][p1]} \${op} \${['‡∏£','‡∏™','‡∏ô','‡∏•‡∏™','‡∏•‡∏ô'][p2]}) + \${con}\`;

            for(let start=0; start<=9; start++) {
                let score=0;
                // Fast Score Check
                for(let i=startIdx; i<=endIdx; i++) { 
                    if(i >= totalChecks) continue;
                    let numsToCheck = [];
                    for(let k=0; k<len; k++) numsToCheck.push((baseSums[i]+start+additives[k])%10);
                    if(checkWin(targetVals[i], numsToCheck, targetType)) score++;
                }
                
                allResults.push({ name: name+" (R"+start+")", score: score, p1, p2, op, con, m1, start, baseSums });
            }
        }
        
        if (displayMode === 'auto') {
            allResults.sort((a,b)=>b.score-a.score);
            allResults = allResults.slice(0, 5);
        } else {
            // Manual Pagination Logic
            let startIndex = (page - 1) * pageSize;
            let endIndex = startIndex + pageSize;
            allResults = allResults.slice(startIndex, endIndex);
        }

        // Full History Generation only for selected results
        return allResults.map(res => {
            let history = [];
            let currentNums = null; let huntCount = 0;
            
            for(let i=1; i<intData.length; i++) {
                 let isLast = i === intData.length - 1;
                 let numsToCheck = [];
                 let isWin = false;
                 
                 // Logic
                 if (isHuntingMode) {
                    if (currentNums === null) { 
                        for(let k=0; k<len; k++) numsToCheck.push((res.baseSums[i]+res.start+additives[k])%10); 
                        currentNums=numsToCheck; huntCount=1; 
                    } else { numsToCheck = currentNums; }
                 } else { 
                    for(let k=0; k<len; k++) numsToCheck.push((res.baseSums[i]+res.start+additives[k])%10); 
                 }
                 
                 if (!isLast) {
                     isWin = checkWin(targetVals[i], numsToCheck, targetType);
                     let record = { nums: numsToCheck, win: isWin, rowIdx: i };
                     if (isHuntingMode) { record.huntRound = huntCount; record.huntMax = huntMax; }
                     
                     // *** FIX: ONLY ADD HISTORY IF WITHIN RANGE ***
                     if (i >= startIdx && i <= endIdx) {
                        history.push(record);
                     }
                     
                     if (isHuntingMode) {
                        if (isWin) currentNums = null; 
                        else { if (huntCount < huntMax) huntCount++; else currentNums = null; }
                     }
                 } else {
                     // Prediction row (Always add)
                     history.push({ nums: numsToCheck, win: null, rowIdx: i });
                 }
            }
            return { name: res.name, score: res.score, history: history, isDimmed: false };
        });
    }
    `;

    // APP VARS
    let currentTarget='hundred', currentTargetLabel='‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢', currentLen=5, displayMode='auto';
    let inputOrder = 'normal', isHuntingMode = false, sortMode = 'score';
    let currentStepMode = 'normal', currentStepLabel='‡πÄ‡∏£‡∏µ‡∏¢‡∏á (+1)';
    let isHeatmapMode = false, myWorker = null, isEditing = false, pinnedList = [];
    let currentLottoType = 'thai', sessionSeed = Math.floor(Math.random() * 100000);
    let globalFlowData = {};
    let currentPage = 1;
    let pageSize = 10;
    let lastCalculatedResults = []; // Store for copy function

    function changeLottoType() { saveCurrentData(); currentLottoType = document.getElementById('lottoSelector').value; loadCurrentData(); updateRenameButton(); }
    function updateRenameButton() { let customName = localStorage.getItem('lottoName_' + currentLottoType); let select = document.getElementById('lottoSelector'); let option = select.querySelector(`option[value="${currentLottoType}"]`); if (customName && option) { let originalText = option.text; let flag = originalText.split(' ')[0]; option.text = flag + ' ' + customName; } }
    function renameLotto() { let newName = prompt("‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ß‡∏¢‡πÉ‡∏´‡∏°‡πà:", ""); if (newName) { localStorage.setItem('lottoName_' + currentLottoType, newName); updateRenameButton(); } }
    function saveCurrentData() { localStorage.setItem('lottoData_' + currentLottoType, document.getElementById('inputData').value); }
    function loadCurrentData() { const saved = localStorage.getItem('lottoData_' + currentLottoType) || ""; document.getElementById('inputData').value = saved; updateDbCount(); updateRenameButton(); if(saved.trim()) { setTimeout(() => { const totalRounds = document.getElementById('rangeEnd').max; if(totalRounds) document.getElementById('rangeEnd').value = totalRounds; updateRangeFromCount(); }, 100); } }
    function toggleTheme() { document.body.classList.toggle('dark-mode'); localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light'); }
    function toggleEditData() { const box = document.getElementById('inputData'); const btn = document.getElementById('btnEdit'); isEditing = !isEditing; box.readOnly = !isEditing; if(isEditing) { box.style.borderColor = '#f97316'; btn.innerText = 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å'; btn.style.background = '#16a34a'; } else { box.style.borderColor = '#cbd5e1'; btn.innerText = '‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç'; btn.style.background = '#f59e0b'; saveCurrentData(); if(box.value.trim()) { updateDbCount(); runProgram(); } } }
    function toggleOrder() { inputOrder = inputOrder==='normal'?'reverse':'normal'; document.getElementById('btnOrder').innerText = inputOrder==='normal'?'‚¨á ‡∏õ‡∏Å‡∏ï‡∏¥':'‚¨Ü ‡∏™‡∏•‡∏±‡∏ö'; }
    function toggleSection(contentId, iconId) { const content = document.getElementById(contentId); const icon = document.getElementById(iconId); if(content.style.display === 'none') { content.style.display = 'block'; icon.innerText = '‚ñº'; } else { content.style.display = 'none'; icon.innerText = '‚ñ≤'; } }
    function toggleDashboard() { toggleSection('dashboardContent', 'dashIcon'); }

    document.addEventListener('DOMContentLoaded', () => { if(localStorage.getItem('theme') === 'dark') document.body.classList.add('dark-mode'); currentLottoType = 'thai'; document.getElementById('lottoSelector').value = 'thai'; let select = document.getElementById('lottoSelector'); for (let i = 0; i < select.options.length; i++) { let val = select.options[i].value; let custom = localStorage.getItem('lottoName_' + val); if (custom) { let flag = select.options[i].text.split(' ')[0]; select.options[i].text = flag + ' ' + custom; } } const oldData = localStorage.getItem('lottoData'); if(oldData && !localStorage.getItem('lottoData_thai')) { localStorage.setItem('lottoData_thai', oldData); localStorage.removeItem('lottoData'); } loadCurrentData(); });

    // HANDLERS
    function setMode(m) { displayMode=m; updateUI(); runProgram(); }
    function setHunt(h) { isHuntingMode=h; updateUI(); if(isHuntingMode) setMode('all'); else runProgram(); }
    /* === ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏±‡∏ö function setTarget ‡πÄ‡∏î‡∏¥‡∏° ‡πÉ‡∏ô github1 === */
function setTarget(val, btn) { 
    // ‡∏•‡∏ö‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    document.querySelectorAll('.btn-target').forEach(b => b.classList.remove('active'));
    
    // ‡πÉ‡∏™‡πà‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏Å‡∏î
    if(btn) {
        btn.classList.add('active'); 
    } else if(event && event.target) {
        event.target.classList.add('active');
    }
    
    // ‡∏™‡∏±‡πà‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (‡πÉ‡∏ä‡πâ Logic ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á github1)
    currentTarget = val; 
    runProgram(); 
}
    function setStep(mode, btn) { currentStepMode = mode; document.querySelectorAll('.btn-step').forEach(b => b.classList.remove('active')); btn.classList.add('active'); runProgram(); }
    function setLen(n, btn) { currentLen = n; document.querySelectorAll('.btn-len').forEach(b => b.classList.remove('active')); btn.classList.add('active'); runProgram(); }
    
    function updateUI() {
        document.getElementById('btnModeAuto').className = displayMode==='auto'?'btn-mode active':'btn-mode';
        document.getElementById('btnModeAll').className = displayMode==='all'?'btn-mode active':'btn-mode';
        document.getElementById('manualLimitInput').style.display = displayMode==='all'?'inline-block':'none';
        document.getElementById('manualControl').style.display = displayMode==='all'?'inline-flex':'none';
        document.getElementById('tableFooterControls').style.display = displayMode==='all'?'flex':'none'; 
        
        document.getElementById('btnHuntOff').className = !isHuntingMode?'btn-hunt active':'btn-hunt';
        document.getElementById('btnHuntOn').className = isHuntingMode?'btn-hunt active':'btn-hunt';
        document.getElementById('huntInputWrap').style.display = isHuntingMode?'flex':'none';
        
        if(displayMode==='auto') {
             setSort('score'); document.getElementById('sortFixed').classList.add('disabled'); document.getElementById('sortScore').classList.remove('disabled');
        } else {
             setSort('fixed'); document.getElementById('sortFixed').classList.remove('disabled'); document.getElementById('sortScore').classList.add('disabled');
        }
    }

    function setSort(mode) { sortMode = mode; document.getElementById('sortScore').className = mode==='score'?'btn-sort active':'btn-sort'; document.getElementById('sortFixed').className = mode==='fixed'?'btn-sort active':'btn-sort'; }
    
    function changePage(delta) {
        let maxLimit = parseInt(document.getElementById('manualLimitInput').value) || 100;
        let maxPage = Math.ceil(maxLimit / pageSize);
        currentPage += delta;
        if(currentPage < 1) currentPage = 1;
        if(currentPage > maxPage) currentPage = maxPage;
        updatePageInfo();
        runProgram();
    }
    
    function updatePageInfo() {
        let start = (currentPage - 1) * pageSize + 1;
        let end = currentPage * pageSize;
        let maxLimit = parseInt(document.getElementById('manualLimitInput').value) || 100;
        if (end > maxLimit) end = maxLimit;
        document.getElementById('pageInfo').innerText = `${start}-${end}`;
    }

    // Improved Update Functions for Input Sync
    function updateDbCount() { 
        const val = document.getElementById('inputData').value.trim(); 
        const parsed = parseInputText(val);
        const count = parsed.rounds.length; 
        document.getElementById('dbCount').innerText = `‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${count} ‡∏á‡∏ß‡∏î`; 
        document.getElementById('rangeCount').max = count; 
        document.getElementById('rangeStart').max = count;
        document.getElementById('rangeEnd').max = count;
        return count;
    }

    function updateRangeFromCount() { 
        let total = updateDbCount();
        let countInput = document.getElementById('rangeCount');
        let val = parseInt(countInput.value);
        if (isNaN(val) || val < 1) { if (val === 0) countInput.value = 1; return; }
        if (val > total) { countInput.value = total; val = total; }
        let newStart = Math.max(1, total - val + 1);
        document.getElementById('rangeStart').value = newStart;
        document.getElementById('rangeEnd').value = total;
        runProgram(); 
    }

    function updateCountFromRange() { 
        let total = updateDbCount();
        let startInput = document.getElementById('rangeStart');
        let endInput = document.getElementById('rangeEnd');
        let countInput = document.getElementById('rangeCount');
        let start = parseInt(startInput.value);
        let end = parseInt(endInput.value);
        
        if (!isNaN(end) && end > total) { end = total; endInput.value = total; }
        if (!isNaN(start) && start > total) { start = total; startInput.value = total; }
        if (!isNaN(start) && !isNaN(end) && start > end) { start = end; startInput.value = end; }
        
        if (!isNaN(start) && !isNaN(end)) {
            let count = end - start + 1;
            if (count < 1) count = 1;
            countInput.value = count;
            runProgram();
        }
    }

    function runProgram() {
        const rawInput = document.getElementById('inputData').value; if(!rawInput.trim()) return;
        updateDbCount(); document.getElementById('loading').style.display='block'; document.getElementById('tableWrapper').style.display='none';
        const parseRes = parseInputText(rawInput);
        if(parseRes.rounds.length < 2) { alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ"); document.getElementById('loading').style.display='none'; return; }
        currentData = parseRes.rounds;
        const intData = currentData.map(r => [parseInt(r.up[0]), parseInt(r.up[1]), parseInt(r.up[2]), parseInt(r.down[0]), parseInt(r.down[1])]);

        renderFlowDashboard(intData); calculateStructure(intData); 
// ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
        autoFillInputs();
        document.getElementById('vinFlowSection').style.display = 'block'; calcVinFlow();
        if(!document.getElementById('rangeEnd').value) updateRangeFromCount();

        const params = {
            intData: intData, targetType: currentTarget, len: parseInt(currentLen),
            displayMode: displayMode, startIdx: Math.max(0, (parseInt(document.getElementById('rangeStart').value)||1) - 1),
            endIdx: Math.min(intData.length - 1, (parseInt(document.getElementById('rangeEnd').value)||intData.length) - 1),
            manualLimit: parseInt(document.getElementById('manualLimitInput').value) || 100,
            killDigits: document.getElementById('killDigits').value,
            isHuntingMode: isHuntingMode, huntMax: parseInt(document.getElementById('huntMax').value) || 3, 
            seed: sessionSeed, stepMode: currentStepMode,
            page: currentPage, pageSize: pageSize
        };
        
        if(myWorker) myWorker.terminate(); 
        const blob = new Blob([workerScript], {type: 'application/javascript'});
        myWorker = new Worker(URL.createObjectURL(blob));
        
        const safetyTimeout = setTimeout(() => { document.getElementById('loading').style.display='none'; if(myWorker) myWorker.terminate(); alert("‚ö†Ô∏è ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ"); }, 300000);
        
        myWorker.onmessage = function(e) {
            clearTimeout(safetyTimeout);
            if(e.data.status === 'error') { document.getElementById('loading').style.display='none'; return; }
            lastResults = e.data.data;
            lastCalculatedResults = e.data.data; 
            renderTable(currentData, lastResults);
            calculateBottomConsensus(lastResults);
            document.getElementById('loading').style.display='none';
            document.getElementById('tableWrapper').style.display='block';
            document.getElementById('consensusSection').style.display='block';
            if(displayMode==='all') document.getElementById('tableFooterControls').style.display = 'flex';
        };
        myWorker.postMessage(params);
    }

    // --- HELPER TO GET TARGET NUMBERS ---
    function getTargetsStr(r, type) {
        let uH=parseInt(r.up[0]), uT=parseInt(r.up[1]), uU=parseInt(r.up[2]);
        let dT=parseInt(r.down[0]), dU=parseInt(r.down[1]);
        if(type==='hundred') return [uH]; if(type==='tens_up') return [uT]; if(type==='units_up') return [uU];
        if(type==='tens_down') return [dT]; if(type==='units_down') return [dU];
        if(type==='tf_up') return [uT,uU]; if(type==='tf_down') return [dT,dU];
        if(type==='pair_up') return [uT,uU]; if(type==='pair_down') return [dT,dU];
        if(type==='any_no_hundred') return [uT,uU,dT,dU];
        return [];
    }

    function renderTable(data, formulas) {
        let pinned = [], unpinned = [];
        formulas.forEach(f => { if(pinnedList.includes(f.name)) pinned.push(f); else unpinned.push(f); });
        let displayFormulas = [...pinned, ...unpinned];

        // --- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πà‡∏° Copy ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Auto Flow Vin (‡πÉ‡∏ä‡πâ class btn-tiny ‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å) ---
        let html = `<table><thead><tr><th style="min-width:160px; z-index:100; left:0;">‡∏ú‡∏• <button class="btn-tiny" onclick="copyHistoryColumn()" title="Copy Results">Copy</button></th>`;
        
        displayFormulas.forEach((f,i) => {
            let isPinned = pinnedList.includes(f.name);
            let wins=0, losses=0;
            f.history.forEach(h => { if(h.win) wins++; else if(h.win===false) losses++; });
            html += `<th style="min-width:140px;">
                        <div style="display:flex; flex-direction:column; align-items:center; gap:4px;">
                            <div style="display:flex; align-items:center; justify-content:center; gap:5px;">
                                <button class="btn-star ${isPinned?'pinned':''}" onclick="togglePin('${f.name}')">‚òÖ</button>
                                <span style="font-size:13px; font-weight:bold;">${f.name}</span>
                                <button class="btn-copy-col" onclick="copyColumn('${f.name}')">üìã</button>
                            </div>
                            <div style="font-size:12px; color:var(--txt-l); background:rgba(0,0,0,0.05); padding:2px 10px; border-radius:10px; font-weight:600;">
                                <span style="color:#16a34a;">‡∏ñ‡∏π‡∏Å ${wins}</span> <span style="color:#cbd5e1;">|</span> <span style="color:#dc2626;">‡∏ú‡∏¥‡∏î ${losses}</span>
                            </div>
                        </div>
                     </th>`;
        });
        html += `</tr></thead><tbody>`;
        let hLen = displayFormulas[0].history.length;
        for(let i=0; i<hLen; i++) {
            let item = displayFormulas[0].history[i];
            let isPred = (i === hLen-1);
            if(isPred) html += `<tr><td style="background:#fef08a;">üîÆ ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢</td>`;
            else { let tr = data[item.rowIdx+1]; html += `<tr><td>${tr.up}-${tr.down}</td>`; }
            displayFormulas.forEach(f => {
                let h = f.history[i];
                let d = h.nums.join('');
                if(isPred) html += `<td><span style="font-weight:bold; color:var(--p);">${d}</span></td>`;
                else {
                    let mark = h.win ? `<span class="stat-t">‚úì</span>` : `<span class="stat-f">‚úó</span>`;
                    let targets = getTargetsStr(data[item.rowIdx+1], currentTarget);
                    let numHtml = '';
                    h.nums.forEach(n => { 
                        if(targets.includes(n)) numHtml += `<span class="num-match">${n}</span>`; 
                        else numHtml += `<span class="num-normal">${n}</span>`; 
                    });
                    
                    let huntTag = "";
                    if (isHuntingMode && h.huntRound) {
                        if (h.win) huntTag = `<span class="hunt-tag win">Win!</span>`; else huntTag = `<span class="hunt-tag wait">‡∏ï‡∏≤‡∏° ${h.huntRound}/${h.huntMax}</span>`;
                    }
                    html += `<td class="num-box" style="text-align:center;">${numHtml} ${mark} ${huntTag}</td>`;
                }
            });
            html += `</tr>`;
        }
        html += `</tbody></table>`;
        document.getElementById('resultContainer').innerHTML = html;
    }

    // --- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏π‡∏ï‡∏£ (‡∏•‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å) ---
    function copyColumn(title) {
        let formula = lastCalculatedResults.find(f => f.name === title);
        if(!formula) return alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏π‡∏ï‡∏£");
        
        let lottoName = document.getElementById('lottoSelector').options[document.getElementById('lottoSelector').selectedIndex].text.split(' ')[1] || '‡∏´‡∏ß‡∏¢';
        let txt = `üìã ‡∏™‡∏π‡∏ï‡∏£: ${title}\nüçô ${lottoName} (‡πÄ‡∏õ‡πâ‡∏≤: ${currentTargetLabel})\n------------------\n`;
        
        formula.history.forEach(h => {
             if (h.win === null) return; 
             let rowData = currentData[h.rowIdx];
             let resStr = `${rowData.up}-${rowData.down}`;
             let nums = h.nums.join('');
             let mark = h.win ? "‚úì" : "‚úó";
             
             // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ: ‡∏•‡∏ö ${h.rowIdx+1}. ‡∏≠‡∏≠‡∏Å
             txt += `${nums} = ${resStr} ${mark}\n`;
        });
        
        let last = formula.history[formula.history.length-1];
        if (last.win === null) {
            txt += `------------------\nüîÆ ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢: ${last.nums.join('')}\n`;
        }
        
        txt += `\nBy ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç`;
        copyText(txt);
    }

    // --- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏á‡∏ß‡∏î/‡∏ú‡∏• ‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô "‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î" ---
    function copyHistoryColumn() {
        if (!currentData || currentData.length === 0) return alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
        let txt = "‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà / ‡∏ú‡∏•\n------------------\n";
        currentData.forEach(r => {
            txt += `${r.i}. ${r.up}-${r.down}\n`;
        });
        copyText(txt);
    }
    
    // --- OTHER HELPERS ---
    function togglePin(name) { if(pinnedList.includes(name)) pinnedList = pinnedList.filter(n => n !== name); else { if(pinnedList.length >= 5) { alert("‡πÄ‡∏ï‡πá‡∏° 5 ‡∏™‡∏π‡∏ï‡∏£"); return; } pinnedList.push(name); } if(lastResults.length > 0) renderTable(currentData, lastResults); }
    function toggleHeatmap() { isHeatmapMode = !isHeatmapMode; if (lastResults.length > 0) renderTable(currentData, lastResults); }
    function copyTable() { navigator.clipboard.writeText("Copied Table"); alert("Copied!"); }
    function copySingleSmartFlow(btn) { copyText(btn.getAttribute('data-text')); }
    function copySmartFlow() { let cards = document.querySelectorAll('.btn-copy-sf'); let allText = ""; cards.forEach(btn => { allText += btn.getAttribute('data-text') + "\n\n====================\n\n"; }); if(allText) copyText(allText); }
    function copyText(t) { navigator.clipboard.writeText(t).then(()=>{ const el=document.getElementById('toast'); el.style.display='block'; setTimeout(()=>el.style.display='none', 1000); }); }
    function appendAndRun() {
        const rawNew = document.getElementById('newData').value.trim();
        if(rawNew) {
            const parsed = parseInputText(rawNew);
            if(parsed.textFormat) {
                const main = document.getElementById('inputData');
                let textToAdd = parsed.textFormat;
                
                // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
                if (inputOrder === 'reverse') {
                    let lines = parsed.rounds.map(r => `${r.up} ${r.down}`);
                    textToAdd = lines.reverse().join('\n');
                }
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å
                main.value = (main.value.trim() ? main.value + "\n" : "") + textToAdd;
                document.getElementById('newData').value = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°
                main.scrollTop = main.scrollHeight; // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                updateDbCount(); 
                
                // --- ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏Ç "‡∏ñ‡∏∂‡∏á‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà" ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏ß‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ---
                const totalRounds = document.getElementById('rangeEnd').max; // ‡∏Ñ‡πà‡∏≤ max ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≤‡∏Å updateDbCount
                document.getElementById('rangeEnd').value = totalRounds;
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏´‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î (Range Count) ‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≠‡∏á "‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î" ‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ô
                updateRangeFromCount(); 
                // ----------------------------------------------------------

                // runProgram(); // updateRangeFromCount calls runProgram already
            } else alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        } else alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
    }
    function clearAll() { if(confirm("‡∏•‡πâ‡∏≤‡∏á?")) { document.getElementById('inputData').value=""; saveCurrentData(); document.getElementById('resultContainer').innerHTML=""; ['flowPanel','consensusSection','copyArea','tableWrapper','structurePanel','vinFlowSection'].forEach(id => document.getElementById(id).style.display='none'); updateDbCount(); } }

    // --- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: Smart Flow (‡∏ï‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏•‡∏Ç‡∏Ç‡πâ‡∏≠‡∏≠‡∏≠‡∏Å) ---
    function genSmartFlow() { 
        if (!currentData || currentData.length === 0) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô");
        
        const targetType = parseInt(document.getElementById('sfTarget').value);
        const len = parseInt(document.getElementById('sfLen').value) || 4;
        const lookback = parseInt(document.getElementById('sfLookback').value) || 15;

        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
        const targetDefs = [
            { id: 0, idx: [0], name: "‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢" }, 
            { id: 1, idx: [1], name: "‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏¥‡∏ö‡∏ö‡∏ô" }, 
            { id: 2, idx: [2], name: "‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏ô" }, 
            { id: 3, idx: [1, 2], name: "‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ö‡∏ô (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏£‡πâ‡∏≠‡∏¢)" }, 
            { id: 4, idx: [3], name: "‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏¥‡∏ö‡∏•‡πà‡∏≤‡∏á" }, 
            { id: 5, idx: [4], name: "‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡πà‡∏≤‡∏á" }, 
            { id: 6, idx: [3, 4], name: "‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏•‡πà‡∏≤‡∏á" }, 
            { id: 7, idx: [1, 2, 3, 4], name: "‡∏ö‡∏ô+‡∏•‡πà‡∏≤‡∏á (‡∏£‡∏ß‡∏°)" }, 
            { id: 8, idx: [1, 2], type: 'sum', name: "‡πÅ‡∏ï‡πâ‡∏°‡∏ö‡∏ô" }, 
            { id: 9, idx: [3, 4], type: 'sum', name: "‡πÅ‡∏ï‡πâ‡∏°‡∏•‡πà‡∏≤‡∏á" }, 
            { id: 10, idx: [1, 2], type: 'vin', name: "‡∏ß‡∏¥‡∏ô‡∏ö‡∏ô (‡∏Ñ‡∏£‡∏ö 2 ‡∏ï‡∏±‡∏ß)" }, 
            { id: 11, idx: [3, 4], type: 'vin', name: "‡∏ß‡∏¥‡∏ô‡∏•‡πà‡∏≤‡∏á (‡∏Ñ‡∏£‡∏ö 2 ‡∏ï‡∏±‡∏ß)" }
        ];

        const selectedTarget = targetDefs[targetType];
        const intData = currentData.map(r => [parseInt(r.up[0]), parseInt(r.up[1]), parseInt(r.up[2]), parseInt(r.down[0]), parseInt(r.down[1])]);
        
        const getDigitsFromRow = (row) => { 
            let digits = []; 
            if (selectedTarget.type === 'sum') { 
                let v1 = row[selectedTarget.idx[0]]; let v2 = row[selectedTarget.idx[1]]; 
                if (!isNaN(v1) && !isNaN(v2)) digits.push((v1+v2)%10); 
            } else { 
                selectedTarget.idx.forEach(idx => { let d = row[idx]; if (!isNaN(d)) digits.push(d); }); 
            } 
            return digits; 
        };

        let candidates = []; 
        function getCombinations(k) { 
            let result = []; let set = [0,1,2,3,4,5,6,7,8,9]; 
            function backtrack(start, current) { 
                if (current.length === k) { result.push([...current]); return; } 
                for (let i = start; i < set.length; i++) { current.push(set[i]); backtrack(i + 1, current); current.pop(); } 
            } 
            backtrack(0, []); return result; 
        }

        let allCombos = getCombinations(len);
        let scored = [];
        let startTest = Math.max(0, currentData.length - lookback);

        allCombos.forEach(digits => {
            let wins = 0; let total = 0; let historyHtml = "";
            let historyText = ""; 
            
            for(let i=startTest; i<currentData.length; i++) {
                let row = intData[i]; 
                let rowDigits = getDigitsFromRow(row); 
                let hit = false;
                
                if (selectedTarget.type === 'vin') { 
                    let matches = 0; rowDigits.forEach(d => { if(digits.includes(d)) matches++; }); 
                    if(matches >= rowDigits.length && rowDigits.length > 0) hit = true; 
                } else { 
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏π‡∏ï‡∏£‡∏°‡∏µ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î)
                    hit = rowDigits.some(d => digits.includes(d)); 
                }
                
                if(hit) wins++; total++;

                let numsStr = ""; 
                digits.forEach(d => { 
                    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏Ç‡∏™‡∏π‡∏ï‡∏£ ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏¥‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (rowDigits) ‡πÉ‡∏´‡πâ‡πÄ‡∏ô‡πâ‡∏ô‡∏™‡∏µ
                    // ‡∏ñ‡πâ‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢ ‡πÅ‡∏ï‡πà‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô rowDigits ‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏™‡∏µ
                    if (rowDigits.includes(d)) numsStr += `<span class="num-match">${d}</span>`; 
                    else numsStr += d; 
                });
                
                let mark = hit ? `<span class="stat-t">‚úì</span>` : `<span class="stat-f">‚úó</span>`;
                historyHtml += `<div class="row-line"><span>${numsStr}</span> <span>${mark}</span></div>`; 
                
                let r3 = currentData[i].up; let r2 = currentData[i].down;
                
                // --- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ: ‡∏ï‡∏±‡∏î‡πÄ‡∏•‡∏Ç‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏≠‡∏≠‡∏Å ---
                historyText += `${digits.join('')} = ${r3}-${r2} ${hit ? "‚úì" : "‚úó"}\n`;
            }
            scored.push({ key: digits.join(''), wins, total, historyHtml, historyText });
        });

        scored.sort((a, b) => b.wins - a.wins);
        let lottoName = document.getElementById('lottoSelector').options[document.getElementById('lottoSelector').selectedIndex].text.split(' ')[1] || '‡∏´‡∏ß‡∏¢';
        let gridHtml = "";
        
        scored.slice(0, 5).forEach((c, idx) => {
             let percent = Math.round((c.wins/c.total)*100);
             let icon = idx===0?"ü•á":(idx===1?"ü•à":(idx===2?"ü•â":"üéñÔ∏è"));
             let fullText = `üçô ${lottoName} ‡πÑ‡∏´‡∏•${selectedTarget.name} ${c.key}\n--------------\n${c.historyText}\n${c.key}\n--------------\n‡∏ñ‡∏π‡∏Å ${c.wins}/${c.total} (${percent}%)`;
             gridHtml += `<div class="sf-card"><div class="sf-card-header"><span>${icon} ‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà ${idx+1}</span><button class="btn-copy-sf" onclick="copySingleSmartFlow(this)" data-text="${fullText}">Copy</button></div><div class="sf-card-body">${c.historyHtml}</div><div class="sf-card-footer"><span style="font-weight:bold; color:var(--p); font-size:16px;">${c.key}</span><span style="font-size:12px; color:${percent>=80?'#16a34a':'var(--txt-l)'}">‡∏ñ‡∏π‡∏Å ${c.wins}/${c.total} (${percent}%)</span></div></div>`;
        });
        document.getElementById('sfOutput').innerHTML = gridHtml;
    }

    function calculateStructure(intData) { const subset = intData.slice(-10); let html = ""; const defs = [{name:"‡∏£‡πâ‡∏≠‡∏¢", idx:[0], cls:"bg-hundred"},{name:"‡∏™‡∏¥‡∏ö‡∏ö‡∏ô", idx:[1], cls:"bg-tens-up"},{name:"‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏ô", idx:[2], cls:"bg-units-up"},{name:"‡∏ö‡∏ô (‡∏£‡∏ß‡∏°)", idx:[1,2], cls:"bg-up-all"},{name:"‡∏™‡∏¥‡∏ö‡∏•‡πà‡∏≤‡∏á", idx:[3], cls:"bg-tens-down"},{name:"‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡πà‡∏≤‡∏á", idx:[4], cls:"bg-units-down"},{name:"‡∏•‡πà‡∏≤‡∏á (‡∏£‡∏ß‡∏°)", idx:[3,4], cls:"bg-down-all"},{name:"‡∏ö‡∏ô+‡∏•‡πà‡∏≤‡∏á (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏£‡πâ‡∏≠‡∏¢)", idx:[1,2,3,4], cls:"bg-all"}]; defs.forEach(d => { let c=0, odd=0, even=0, high=0, low=0; subset.forEach(r => { d.idx.forEach(i=>{ if(!isNaN(r[i])) { c++; if(r[i]%2!==0) odd++; else even++; if(r[i]>=5) high++; else low++; } }); }); let oS = odd > even ? '<span style="color:#f59e0b; margin-left:2px;">‚òÖ</span>' : ''; let eS = even > odd ? '<span style="color:#f59e0b; margin-left:2px;">‚òÖ</span>' : ''; let hS = high > low ? '<span style="color:#f59e0b; margin-left:2px;">‚òÖ</span>' : ''; let lS = low > high ? '<span style="color:#f59e0b; margin-left:2px;">‚òÖ</span>' : ''; html += `<div class="struct-card"><div class="flow-header ${d.cls}">${d.name}</div><div class="struct-body" style="font-size:16px; font-weight:800; line-height:1.8;"><div style="color:var(--txt);">‡∏Ñ‡∏µ‡πà: ${odd}${oS} <span style="color:#cbd5e1; font-weight:normal; margin:0 5px;">|</span> ‡∏Ñ‡∏π‡πà: ${even}${eS}</div><div style="color:var(--txt); border-top:1px dashed #e2e8f0;">‡∏™‡∏π‡∏á: ${high}${hS} <span style="color:#cbd5e1; font-weight:normal; margin:0 5px;">|</span> ‡∏ï‡πà‡∏≥: ${low}${lS}</div></div></div>`; }); document.getElementById('structGridWrapper').innerHTML = html; document.getElementById('structurePanel').style.display='block'; }
    function renderFlowDashboard(intData) { let html = ''; const defs = [{name:"1.‡∏£‡πâ‡∏≠‡∏¢", idx:[0], cls:"bg-hundred"},{name:"2.‡∏™‡∏¥‡∏ö‡∏ö‡∏ô", idx:[1], cls:"bg-tens-up"},{name:"3.‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏ô", idx:[2], cls:"bg-units-up"},{name:"4.‡∏ö‡∏ô (‡∏£‡∏ß‡∏°)", idx:[1,2], cls:"bg-up-all"},{name:"5.‡∏™‡∏¥‡∏ö‡∏•‡πà‡∏≤‡∏á", idx:[3], cls:"bg-tens-down"},{name:"6.‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡πà‡∏≤‡∏á", idx:[4], cls:"bg-units-down"},{name:"7.‡∏•‡πà‡∏≤‡∏á (‡∏£‡∏ß‡∏°)", idx:[3,4], cls:"bg-down-all"},{name:"8.‡∏ö‡∏ô+‡∏•‡πà‡∏≤‡∏á", idx:[1,2,3,4], cls:"bg-all"},{name:"9.‡πÅ‡∏ï‡πâ‡∏°‡∏ö‡∏ô", idx:[1,2], type:'sum', cls:"bg-sum-top"},{name:"10.‡πÅ‡∏ï‡πâ‡∏°‡∏•‡πà‡∏≤‡∏á", idx:[3,4], type:'sum', cls:"bg-sum-bot"}]; defs.forEach(d=>{ let counts = Array(10).fill(0); intData.forEach(r=>{ if(d.type==='sum') { if(!isNaN(r[d.idx[0]])) counts[(r[d.idx[0]]+r[d.idx[1]])%10]++; } else { d.idx.forEach(i=>{ if(!isNaN(r[i])) counts[r[i]]++ }); } }); let sorted = counts.map((c,n)=>({n,c})).sort((a,b)=>b.c-a.c).map(x=>x.n).join(''); html += `<div class="flow-card"><div class="flow-header ${d.cls}">${d.name}</div><div class="flow-body"><div class="flow-num-row">${sorted}</div></div></div>`; if(!d.type) globalFlowData[d.cls] = sorted.split(''); }); document.getElementById('flowGridWrapper').innerHTML=html; document.getElementById('flowPanel').style.display='block'; }
    function calculateBottomConsensus(formulas) { if(!formulas.length) return; let source = displayMode==='auto' ? formulas.slice(0,5) : formulas; let counts = Array(10).fill(0); source.forEach(f => { if(f.history.length) f.history[f.history.length-1].nums.forEach(n => counts[n]++) }); let html = ''; counts.map((c,n)=>({n,c})).sort((a,b)=>b.c-a.c).forEach(x => { if(x.c>0) html+=`<div class="hit-item"><div class="hit-badge" style="background:#f97316;width:40px;height:40px;border-radius:50%;color:white;display:flex;align-items:center;justify-content:center;font-weight:bold;">${x.n}</div><div style="font-size:12px;margin-top:5px;">‡∏ä‡∏ô ${x.c}</div></div>` }); document.getElementById('consensusContent').innerHTML = html; }
    function calcVinFlow() { let limit = parseInt(document.getElementById('vinFlowLimit').value)||5; let killVal = document.getElementById('vinFlowSumKill').value.trim(); let killSum = killVal ? killVal.replace(/[^0-9]/g, '').split('').map(Number) : []; let tUp = globalFlowData['bg-tens-up'] ? globalFlowData['bg-tens-up'].slice(0, limit) : []; let uUp = globalFlowData['bg-units-up'] ? globalFlowData['bg-units-up'].slice(0, limit) : []; let tDown = globalFlowData['bg-tens-down'] ? globalFlowData['bg-tens-down'].slice(0, limit) : []; let uDown = globalFlowData['bg-units-down'] ? globalFlowData['bg-units-down'].slice(0, limit) : []; const genPairs = (t, u) => { let arr = []; if (!t || !u) return []; t.forEach(tens => { u.forEach(units => { let pair = tens + "" + units; let sum = (parseInt(tens) + parseInt(units)) % 10; if (killSum.length === 0 || !killSum.includes(sum)) arr.push(pair); }); }); return arr.sort((a,b) => parseInt(a) - parseInt(b)); }; window.currentVinUpArr = genPairs(tUp, uUp); window.currentVinDownArr = genPairs(tDown, uDown); window.currentVinLimit = limit; const renderBox = (arr, tens, units) => { let header = `<div style="margin-bottom:8px; color:var(--txt-l); font-size:14px; font-weight:bold;">‡∏™‡∏¥‡∏ö: <span style="color:var(--p)">${tens.join('')}</span> | ‡∏´‡∏ô‡πà‡∏ß‡∏¢: <span style="color:var(--p)">${units.join('')}</span></div>`; if(!arr.length) return header + "..."; let lines = []; for (let i = 0; i < arr.length; i += limit) lines.push(arr.slice(i, i + limit).join(' - ')); let footer = `<div style="margin-top:8px; font-size:12px; color:var(--txt-l); opacity:0.8;">(${arr.length} ‡∏ä‡∏∏‡∏î)</div>`; return header + `<div style="border-top:1px dashed var(--border); padding-top:10px; line-height:1.8;">${lines.join('<br>')}</div>` + footer; }; document.getElementById('vinFlowUpContent').innerHTML = renderBox(window.currentVinUpArr, tUp, uUp); document.getElementById('vinFlowDownContent').innerHTML = renderBox(window.currentVinDownArr, tDown, uDown); }
    // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô 1: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏•‡∏Ç‡∏ï‡∏≤‡∏° (Cross-Position & Sum & High/Low) ---
function calcFollowing() {
    if (!currentData || currentData.length < 2) return alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠");

    const targetNum = parseInt(document.getElementById('followNum').value);
    const sPos = parseInt(document.getElementById('sourcePos').value);
    const tPos = parseInt(document.getElementById('targetPos').value);
    
    const getValue = (row, pos) => {
        if (pos <= 4) return row[pos];
        if (pos === 5 && !isNaN(row[1]) && !isNaN(row[2])) return (row[1] + row[2]) % 10;
        if (pos === 6 && !isNaN(row[3]) && !isNaN(row[4])) return (row[3] + row[4]) % 10;
        return NaN;
    };

    const intData = currentData.map(r => [
        parseInt(r.up[0]), parseInt(r.up[1]), parseInt(r.up[2]), 
        parseInt(r.down[0]), parseInt(r.down[1])
    ]);

    let counts = Array(10).fill(0);
    let foundCount = 0;
    let highCount = 0; 
    let lowCount = 0;  
    
    for (let i = 1; i < intData.length; i++) {
        let currentDraw = intData[i];   
        let nextDraw = intData[i-1];    

        let sVal = getValue(currentDraw, sPos);
        
        if (!isNaN(sVal) && sVal === targetNum) {
            let tVal = getValue(nextDraw, tPos);
            if (!isNaN(tVal)) {
                counts[tVal]++;
                foundCount++;
                if (tVal >= 5) highCount++; else lowCount++;
            }
        }
    }

    const outputDiv = document.getElementById('followOutput');
    const hlDiv = document.getElementById('hlPrediction');

    if (foundCount === 0) {
        outputDiv.innerHTML = `<div style="grid-column:1/-1; text-align:center; color:red;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</div>`;
        hlDiv.style.display = 'none';
        return;
    }

    let highP = Math.round((highCount / foundCount) * 100);
    let lowP = 100 - highP;
    hlDiv.style.display = 'block';
    hlDiv.innerHTML = `
        <div style="font-weight:bold; margin-bottom:5px; color:#334155;">üîÆ ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏™‡∏π‡∏á-‡∏ï‡πà‡∏≥ (‡∏à‡∏≤‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥)</div>
        <div style="display:flex; height:20px; border-radius:10px; overflow:hidden;">
            <div style="width:${lowP}%; background:#f59e0b; color:white; font-size:12px; display:flex; align-items:center; justify-content:center;">‡∏ï‡πà‡∏≥ ${lowP}%</div>
            <div style="width:${highP}%; background:#10b981; color:white; font-size:12px; display:flex; align-items:center; justify-content:center;">‡∏™‡∏π‡∏á ${highP}%</div>
        </div>
        <div style="font-size:12px; color:#64748b; margin-top:3px;">(‡∏ï‡πà‡∏≥ 0-4 | ‡∏™‡∏π‡∏á 5-9)</div>
    `;

    let sorted = counts.map((c, n) => ({ n, c })).sort((a, b) => b.c - a.c);
    currentFollowStr = sorted.map(item => item.n).join('');
    let html = "";
    sorted.forEach(item => {
        let percent = Math.round((item.c / foundCount) * 100);
        let barColor = '#10b981'; 
        if(percent >= 20) barColor = '#ef4444';
        else if(percent >= 12) barColor = '#f59e0b';

        html += `
            <div style="display:flex; flex-direction:column; align-items:center; gap:5px; padding:5px; border:1px solid #e2e8f0; border-radius:8px; background:#fff;">
                <div style="font-size:12px; font-weight:bold; color:#64748b;">${percent}%</div>
                <div style="width:100%; height:50px; background:#f1f5f9; border-radius:5px; position:relative; display:flex; align-items:flex-end; justify-content:center;">
                    <div style="width:60%; height:${Math.max(5, percent * 1.5)}%; background:${barColor}; border-radius:3px 3px 0 0;"></div>
                </div>
                <div style="font-size:18px; font-weight:800; color:#1e293b;">${item.n}</div>
                <div style="font-size:10px; color:#94a3b8;">(${item.c})</div>
            </div>
        `;
    });
    outputDiv.innerHTML = html + `<div style="grid-column:1/-1; text-align:center; font-size:12px; margin-top:10px; color:#64748b;">‡∏à‡∏≤‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á ${foundCount} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>`;
}

// --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô 2: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏•‡∏Ç‡∏ï‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà (Pair Follow) ---
function calcPairFollow() {
    if (!currentData || currentData.length < 2) return alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠");
    
    let inputVal = document.getElementById('pairInput').value;
    if(inputVal === '' || inputVal.length < 2) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏π‡πà (‡πÄ‡∏ä‡πà‡∏ô 85)");
    let targetPair = parseInt(inputVal);
    
    let sPos = document.getElementById('pairSourcePos').value;
    let tPos = document.getElementById('pairTargetPos').value;
    
    const getPair = (row, type) => {
        if(type === 'up') {
            if(!isNaN(row[1]) && !isNaN(row[2])) return row[1]*10 + row[2];
        } else {
            if(!isNaN(row[3]) && !isNaN(row[4])) return row[3]*10 + row[4];
        }
        return NaN;
    }
    
    const intData = currentData.map(r => [
        parseInt(r.up[0]), parseInt(r.up[1]), parseInt(r.up[2]), 
        parseInt(r.down[0]), parseInt(r.down[1])
    ]);

    let counts = Array(100).fill(0);
    let foundCount = 0;
    let lowCount = 0; 
    let highCount = 0; 
    
    for(let i=1; i<intData.length; i++) {
        let cur = getPair(intData[i], sPos);
        if(cur === targetPair) {
            let next = getPair(intData[i-1], tPos);
            if(!isNaN(next)) {
                counts[next]++;
                foundCount++;
                if(next >= 50) highCount++; else lowCount++;
            }
        }
    }
    
    const outputDiv = document.getElementById('pairOutput');
    const hlDiv = document.getElementById('pairHlPrediction');

    if (foundCount === 0) {
        outputDiv.innerHTML = `<div style="grid-column:1/-1; text-align:center; color:red;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏π‡πà ${targetPair}</div>`;
        hlDiv.style.display = 'none';
        return;
    }

    let highP = Math.round((highCount / foundCount) * 100);
    let lowP = 100 - highP;
    hlDiv.style.display = 'block';
    hlDiv.innerHTML = `
        <div style="font-weight:bold; margin-bottom:5px; color:#059669;">üìä ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏π‡πà ‡∏™‡∏π‡∏á-‡∏ï‡πà‡∏≥</div>
        <div style="display:flex; height:20px; border-radius:10px; overflow:hidden;">
            <div style="width:${lowP}%; background:#f59e0b; color:white; font-size:12px; display:flex; align-items:center; justify-content:center;">‡∏ï‡πà‡∏≥ ${lowP}%</div>
            <div style="width:${highP}%; background:#10b981; color:white; font-size:12px; display:flex; align-items:center; justify-content:center;">‡∏™‡∏π‡∏á ${highP}%</div>
        </div>
        <div style="font-size:12px; color:#64748b; margin-top:3px;">(00-49 | 50-99)</div>
    `;

    let sorted = counts.map((c, n) => ({ n, c })).sort((a, b) => b.c - a.c).slice(0, 10);
    let html = "";
    
    sorted.forEach(item => {
        if(item.c === 0) return;
        let pairStr = item.n.toString().padStart(2, '0');
        let percent = Math.round((item.c / foundCount) * 100);
        
        html += `
            <div style="text-align:center; padding:5px; border:1px solid #e2e8f0; border-radius:8px; background:#fff;">
                <div style="font-size:20px; font-weight:bold; color:#059669;">${pairStr}</div>
                <div style="font-size:12px; color:#64748b;">${percent}% (${item.c})</div>
            </div>
        `;
    });
    
    outputDiv.innerHTML = html;
}
// --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°: ‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡∏á‡∏ß‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏ï‡∏±‡∏ß‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î) ‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ---

function getLatestRound() {
    if (!currentData || currentData.length === 0) return null;
    // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: ‡∏î‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á Array (‡∏á‡∏ß‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î)
    return currentData[currentData.length - 1]; 
}

// 1. ‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß (Single Digit)
function setFollowFromLatest() {
    const latest = getLatestRound();
    if (!latest) return;
    
    const sPos = parseInt(document.getElementById('sourcePos').value);
    let val = NaN;

    // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    if (sPos === 0) val = parseInt(latest.up[0]);      // ‡∏£‡πâ‡∏≠‡∏¢
    else if (sPos === 1) val = parseInt(latest.up[1]); // ‡∏™‡∏¥‡∏ö‡∏ö‡∏ô
    else if (sPos === 2) val = parseInt(latest.up[2]); // ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏ô
    else if (sPos === 3) val = parseInt(latest.down[0]); // ‡∏™‡∏¥‡∏ö‡∏•‡πà‡∏≤‡∏á
    else if (sPos === 4) val = parseInt(latest.down[1]); // ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡πà‡∏≤‡∏á
    else if (sPos === 5) val = (parseInt(latest.up[1]) + parseInt(latest.up[2])) % 10; // ‡πÅ‡∏ï‡πâ‡∏°‡∏ö‡∏ô
    else if (sPos === 6) val = (parseInt(latest.down[0]) + parseInt(latest.down[1])) % 10; // ‡πÅ‡∏ï‡πâ‡∏°‡∏•‡πà‡∏≤‡∏á

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á input
    if (!isNaN(val)) {
        document.getElementById('followNum').value = val;
    }
}

// 2. ‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏π‡πà (Pair)
function setPairFromLatest() {
    const latest = getLatestRound();
    if (!latest) return;

    const sPos = document.getElementById('pairSourcePos').value;
    let val = "";

    if (sPos === 'up') {
        // ‡∏ö‡∏ô: ‡πÄ‡∏≠‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏¥‡∏ö+‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà 2 ‡πÅ‡∏•‡∏∞ 3 ‡∏Ç‡∏≠‡∏á‡∏™‡∏ï‡∏£‡∏¥‡∏á 3 ‡∏ï‡∏±‡∏ß)
        val = latest.up.substring(1, 3);
    } else {
        // ‡∏•‡πà‡∏≤‡∏á: ‡πÄ‡∏≠‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        val = latest.down;
    }

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á input
    if (val) {
        document.getElementById('pairInput').value = val;
    }
}

// 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏ß‡∏° (‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡∏Å‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì)
function autoFillInputs() {
    setFollowFromLatest();
    setPairFromLatest();
}
    function copyFlowVin(type) { let arr = (type === 'up') ? window.currentVinUpArr : window.currentVinDownArr; let label = (type === 'up') ? '‡∏ß‡∏¥‡∏ô‡∏ö‡∏ô' : '‡∏ß‡∏¥‡∏ô‡∏•‡πà‡∏≤‡∏á'; if (!arr || arr.length === 0) return; let limit = window.currentVinLimit || 5; let total = arr.length; let formattedContent = ""; for (let i = 0; i < arr.length; i += limit) formattedContent += arr.slice(i, i + limit).join(' - ') + "\n"; let txt = `${label}‡∏ï‡∏£‡∏á ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${total} ‡∏ï‡∏±‡∏ß\n------------------\n${formattedContent}\n‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ ‡∏ñ‡∏π‡∏Å‡∏´‡∏ß‡∏¢`; copyText(txt); }
    function copyText(t) { navigator.clipboard.writeText(t).then(()=>{ const el=document.getElementById('toast'); el.style.display='block'; setTimeout(()=>el.style.display='none', 1000); }); }
    function parseInputText(text) { let nums = text.match(/\d+/g); if(!nums) return {rounds:[], textFormat:""}; let rounds=[], tempUp=null, idx=1; nums.forEach(n => { if(n.length===5) rounds.push({i:idx++, up:n.substring(0,3), down:n.substring(3,5)}); else if(n.length===3) tempUp=n; else if(n.length===2 && tempUp) { rounds.push({i:idx++, up:tempUp, down:n}); tempUp=null; } }); if(rounds.length) return {rounds:rounds, textFormat:rounds.map(r=>`${r.up} ${r.down}`).join('\n')}; return {rounds:[], textFormat:""}; }

function copyFollowResult() {
    if (!currentFollowStr) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° '‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå' ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å");
        return;
    }
    copyText(currentFollowStr);
}

</script>
</body>
</html>

